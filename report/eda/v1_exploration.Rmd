---
title: "v1_exploration"
author: "Joan Claverol Romero"
date: "25/11/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# libraries
if (require(pacman) == FALSE) {
  install.packages("pacman")
}
pacman::p_load(tidyverse, magrittr)
# define themes for the plots
theme_set(theme_bw())
```

I am currently working on my undergraduate thesis about sentiment analysis, and I am planning to use Amazon customer reviews on cell phones. There are other existing datasets on Amazon mobile/cell phones, but this dataset focuses on both unlocked and locked carriers, and scoped on ten brands: ASUS, Apple, Google, HUAWEI, Motorola, Nokia, OnePlus, Samsung, Sony, and Xiaomi.

## First exploration

```{r load the data}
items <- read_csv("data/raw/20190928-items.csv", 
                  col_types = cols(
                    prices = col_number()
                  ))
glimpse(items)
```

Notes from items data set:

* Check unique ASIN
* Maybe check typs of brands
* Rating? Internal reference? Info Kaggle: Product Avg. Rating. Maybe the number of stars
* Total number of review maybe has some correlation with prices. Easy to check
* **Main goal. Can I predict the prices by using the information like the rating Avg., the number of total reviews and maybe some other info**?

```{r}
reviews <- read_csv("data/raw/20190928-reviews.csv")
glimpse(reviews)
```

Notes: 

* Merge information using ASIN code
* Can I found bots or other problems based on names? Maybe a specific client that comments a lot
* rating of starts from 1 to 5 
* dates can give us some information?? Find high moment of sells. Extra work to properly format the dates
* verified? Maybe a good validator to check for bots
* title analysis. Relevant after to know the number of starts]
* description of the botes. Sentiment analysis? Structure? 
* Validation of the community by using helpful votes. 

A quick idea would be to create a model to predict the price based on the items data: 

# Price distribution

```{r}
items %>% 
  drop_na(prices) %>% 
  ggplot(aes(x = "", y = prices)) + 
    geom_boxplot(alpha = 0.5) +
    geom_violin(fill = "dodgerblue4", alpha = 0.3) +
    scale_y_continuous(labels = scales::dollar) +
    coord_flip() +
    labs(title = "Price distribution") + 
    theme(
      axis.title = element_blank()
    )
```

Of the information we see, there are some clear outlies with a bigger price than > $500. Maybe we can create a cluster of premium phones. Even that, the distribution is positive skewed. 

Maybe we can create three categories here: 

* Low_price : 0 to 250$
* Medium_price: 250 to 450$
* High_price: > 450$

```{r}
items %<>% 
  mutate(price_group = if_else(between(prices, 0, 250), "low_price", 
                               if_else(between(prices, 250, 450), "medium_price",
                                       if_else(prices > 450, "high_price",
                                               "unknown_price"))), 
         price_group = if_else(is.na(price_group), "unknown_price", price_group)
    ) 
items %>% 
  filter(!is.na(price_group)) %>% 
  ggplot(aes(x = prices, fill = price_group)) +
    geom_density(alpha = 0.3)
```

### Right formats of the dates

```{r}
reviews %>% 
  mutate()
```

